!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const i=e=>new Promise(t=>setTimeout(t,e)),r=(e,t,n,i)=>Math.sqrt(Math.pow(e-t,2)+Math.pow(n-i,2));class o{constructor(e,t=null,n=null,i=null){this.value=e,this.left=n,this.right=i,this.parent=t,this.height=0,this.level=0,this.extras={initialized:!1,entered:!1}}}class s{static*push(e,t,n=null,i=0){return e?(t>e.value?(yield{highlightedNode:e,info:`Inserting ${t} | ${t} is bigger than ${e.value} so we go right!`},e.right=yield*s.push(e.right,t,e,i+1)):t<e.value?(yield{highlightedNode:e,info:`Inserting ${t} | ${t} is less than ${e.value} so we go left!`},e.left=yield*s.push(e.left,t,e,i+1)):yield{highlightedNode:null,info:""},e.height=Math.max(s.height(e.left),s.height(e.right))+1,e.level=i,e):(yield{info:"",highlightedNode:null},new o(t,n))}static height(e){return e?e.height:0}static breadthFirstTraverse(e,t){if(!e)return;const n=[];for(n.push(e);n.length;){const e=n.shift();t(e),e.left&&n.push(e.left),e.right&&n.push(e.right)}}}const a=(e,t=0,n=0)=>{0===t&&0===n||s.breadthFirstTraverse(e,e=>{e.extras.x+=t,e.extras.x+=n})},l=(e,t)=>{let n=t.parent;const{padding:i,radius:r}=e;for(;n;){if(t.value>n.value&&t.extras.x<=n.extras.x){a(n.right,n.extras.x-t.extras.x+i+2*r),s.breadthFirstTraverse(n.right,t=>{l(e,t)});break}if(t.value<n.value&&t.extras.x>=n.extras.x){a(n.left,-(t.extras.x-n.extras.x+i+2*r)),s.breadthFirstTraverse(n.left,t=>{l(e,t)});break}n=n.parent}},d=(e,t,n=null)=>{if(t){if(t.extras.initialized)t.extras.entered||(t.extras.multiplier+=.06,t.extras.multiplier>1&&(t.extras.entered=!0));else{t.extras.multiplier=0;const{x:i,y:r}=((e,t,n)=>{const{radius:i,padding:r,dimensions:o}=e;return n?{x:n.extras.x+(n.left===t?-1:1)*(r+2*i),y:n.extras.y+r+2*i}:{x:0,y:-o.height/2+r+i}})(e,t,n);t.extras.x=i,t.extras.y=r,l(e,t),(e=>{const{camera:t,tree:n}=e;s.breadthFirstTraverse(n,e=>{t.bounds.minX=Math.min(e.extras.x,t.bounds.minX),t.bounds.minY=Math.min(e.extras.y,t.bounds.minY),t.bounds.maxX=Math.max(e.extras.x,t.bounds.maxX),t.bounds.maxY=Math.max(e.extras.y,t.bounds.maxY)})})(e),t.extras.initialized=!0}d(e,t.left,t),d(e,t.right,t)}},h=(e,t,n=null)=>{if(!t)return;const{lineWidth:i,radius:o,fontSize:s,highlightedNode:a,ctx:l,colors:d}=e;if(l.save(),l.lineWidth=i,l.font=s+"pt Arial",n){l.save(),l.strokeStyle=d.connector;const e=n.extras.x-t.extras.x,i=n.extras.y-t.extras.y,s=Math.atan2(i,e),a={x:n.extras.x-o*Math.cos(s),y:n.extras.y-o*Math.sin(s)},h=r(n.extras.x,t.extras.x,n.extras.y,t.extras.y)-2*o,u={x:a.x+h*t.extras.multiplier*Math.cos(s+Math.PI),y:a.y+h*t.extras.multiplier*Math.sin(s+Math.PI)};l.beginPath(),l.moveTo(a.x,a.y),l.lineTo(u.x,u.y),l.stroke(),l.restore()}let{x:u,y:c}=t.extras;if(l.fillStyle=d.nodeBackground,l.strokeStyle=t===a?d.nodeBorderHighlight:d.nodeBorder,l.beginPath(),l.arc(u,c,t.extras.multiplier*o,0,2*Math.PI),l.stroke(),l.fill(),l.fillStyle=t===a?d.nodeTextHighlight:d.nodeText,t.extras.entered){const e=l.measureText(t.value);l.fillText(t.value,u-e.width/2,c+l.measureText("M").width/2-2)}l.restore(),h(e,t.left,t),h(e,t.right,t)},u=e=>{const{radius:t,headsup:n,fontSize:i,ctx:o,info:s,lineWidth:a,colors:l}=e,{nextPos:{x:d,y:h},curPos:{x:u,y:c}}=n,x=r(d,u,h,c)*n.multiplier,m=(g=d,y=u,f=h,p=c,Math.atan2(f-p,g-y));var g,y,f,p;const w=x*Math.cos(m),v=x*Math.sin(m);o.font=.8*i+"pt Arial",o.save();const{width:b}=o.measureText(s),{width:M}=o.measureText("M");o.fillStyle=l.headsupBackground,o.fillRect(u+w+t+10,c+v-M/2-10,b+20,M+10),o.fillStyle=l.headsupColor,o.fillText(s,u+w+t+20,c+v),o.strokeStyle=l.headsupColor,o.lineWidth=a;const k=u+w,P=c+v-t-20;o.beginPath(),o.moveTo(k,P),o.lineTo(k,P-50),o.stroke(),o.beginPath(),o.moveTo(k,P+10),o.lineTo(k-10,P-5),o.lineTo(k+10,P-5),o.fill(),o.restore()};const c=document.querySelector("#canvas"),x={canvas:c,ctx:c.getContext("2d"),headsup:{curPos:{},nextPos:{},transitioned:!0,initialized:!1,multiplier:0},delay:2e3,highlightedNode:null,info:"",dimensions:{width:window.innerWidth,height:window.innerHeight},tree:null,mouse:{downPos:{x:0,y:0},oldCamera:{x:0,y:0},isDown:!1},camera:{x:0,y:0,zoom:1,bounds:{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0}},colors:{nodeBorder:"black",nodeText:"black",nodeBorderHighlight:"red",nodeTextHighlight:"red",nodeBackground:"white",connector:"black",headsupBackground:"white",headsupColor:"red"},radius:30,padding:20,fontSize:14,lineWidth:5,inserting:!1},m=()=>{const{dimensions:{width:e,height:t},camera:n,highlightedNode:i,headsup:r,ctx:o}=x,s=e/2,a=t/2;o.save(),o.translate(s+n.x,a+n.y),o.scale(n.zoom,n.zoom),o.clearRect(100*-s,100*-a,200*e,200*t),d(x,x.tree),h(x,x.tree),i?((e=>{const{highlightedNode:t,headsup:n}=e,{x:i,y:r}=t.extras;if(!n.initialized)return n.curPos={x:i,y:r},n.nextPos={x:i,y:r},n.initialized=!0,void(n.transitioned=!0);n.transitioned?(n.nextPos={x:i,y:r},n.transitioned=!1,n.multiplier=0):(n.multiplier>=1&&(n.curPos={...n.nextPos},n.transitioned=!0),n.multiplier=Math.min(n.multiplier+.1,1))})(x),u(x)):r.initialized=!1,o.restore(),window.requestAnimationFrame(m)};!function(e){const t=document.querySelector("#insert"),n=document.querySelector("#delay"),r=document.querySelector("#random"),o=document.querySelector("#help"),a=document.querySelector("#download-link");n.value=e.delay;const l=()=>{const{dimensions:t,canvas:n}=e;t.width=window.innerWidth,t.height=window.innerHeight,n.width=t.width,n.height=t.height};async function d(e,t){const n=s.push(e.tree,t);let r=n.next();for(;!r.done;){const{highlightedNode:t,info:o}=r.value;e.highlightedNode=t,e.info=o,e.highlightedNode&&await i(e.delay),r=n.next()}return r.value}window.addEventListener("resize",l),l(),canvas.addEventListener("mousedown",({clientX:t,clientY:n})=>{const{mouse:i,camera:r,canvas:o}=e;i.downPos.x=t,i.downPos.y=n,i.oldCamera.x=r.x,i.oldCamera.y=r.y,i.isDown=!0,o.style.cursor="grabbing"}),window.addEventListener("mouseup",()=>{const{mouse:t,canvas:n}=e;t.isDown=!1,n.style.cursor="grab"}),window.addEventListener("keydown",({key:t})=>{const{camera:n}=e;switch(t){case"ArrowUp":n.zoom+=.05;break;case"ArrowDown":n.zoom=Math.max(n.zoom-.05,0)}}),window.addEventListener("mousemove",({clientX:t,clientY:n})=>{const{mouse:i,tree:r,camera:o}=e;if(i.isDown&&r){const e=t-i.downPos.x+i.oldCamera.x,r=n-i.downPos.y+i.oldCamera.y;o.x=e,o.y=r}}),t.parentNode.querySelector("button").addEventListener("click",()=>{const{value:n}=t;e.inserting||n.length&&!Number.isNaN(+n)&&(e.inserting=!0,t.value="",s.push(e,e.tree,+n).then(t=>{e.tree=t,e.inserting=!1}))}),n.parentNode.querySelector("button").addEventListener("click",()=>{const{value:t}=n;t.length&&!Number.isNaN(+t)&&(d(e,t).then(t=>{e.tree=t,e.inserting=!1}).catch(console.log),e.delay=+t)}),r.addEventListener("click",async()=>{e.inserting||(e.inserting=!0,d(e,Math.floor(1e3*Math.random())).then(t=>{e.tree=t,e.inserting=!1}).catch(console.log))}),document.querySelector("#close-help").addEventListener("click",()=>{o.style.display="none"}),document.querySelector("#open-help").addEventListener("click",()=>{o.style.display="block"}),document.querySelector("#download").addEventListener("click",()=>{if(!e.tree)return;const{camera:t,radius:n,padding:i,dimensions:r,canvas:o}=e,s=t.zoom,l={x:t.x,y:t.y},d=2*(n+i);t.zoom=1,t.x=-t.bounds.minX-r.width/2+d/2,t.y=-t.bounds.minY-r.height/2+d/2,o.width=t.bounds.maxX-t.bounds.minX+d,o.height=t.bounds.maxY-t.bounds.minY+d,setTimeout(()=>{const e=o.toDataURL("image/png"),n=`bst_${Date.now()}.png`;a.href=e,a.download=n,a.click(),t.zoom=s,o.width=r.width,o.height=r.height,t.x=l.x,t.y=l.y},100)})}(x),window.requestAnimationFrame(m)}])}));
//# sourceMappingURL=bundle.min.js.map